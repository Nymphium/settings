#!/bin/bash


if [ -z $1 ]; then
	echo "please put Network SSID"

	exit
else
	sudo nice -n0 killall -r wpa_supplicant
fi


#confirm wireless Network Interface is UP or DOWN
IF_UP=`nice -n1 ip link | awk 'NR==5' | sed -e "s/.*\(UP\),.*/\1/" | sed -e "s/\s//g"`

if [ $IF_UP != UP ]; then
	sudo ip link set wlp6s0 up
fi

ID=$1

PASS=$2

if [ ${#PASS} -lt 1 ]; then # if no password
	sudo iw wlp6s0 connect ${ID}
elif [ ${#PASS} -lt 8 ]; then # if password-length < 8
	sudo iw wlp6s0 connect ${ID} key 0:${PASS}
else
	WPA_CONF=/etc/wpa_supplicant/wpa_supplicant.conf

	echo "ctrl_interface=/var/run/wpa_supplicant GROUP=wheel" > ${WPA_CONF}

	sudo wpa_passphrase ${ID} ${PASS}  ${WPA_CONF} >> ${WPA_CONF}

	sudo sed -ie "/${PASS}/d" ${WPA_CONF}

	sudo wpa_supplicant -B -iwlp6s0 -c ${WPA_CONF} > /dev/null
fi
