# vim: ft=tmux.conf
set-window-option -g mode-keys vi

# prefix key: Alt-b (matches Zellij's "tmux mode" trigger)
set-option -g prefix M-b
bind-key M-b send-prefix
unbind-key C-b

# ── No-prefix bindings (Zellij normal mode) ──

# Pane navigation: Alt + arrows
bind-key -n M-Left select-pane -L
bind-key -n M-Down select-pane -D
bind-key -n M-Up select-pane -U
bind-key -n M-Right select-pane -R

# Split panes: Alt-Shift-V (horizontal), Alt-Shift-W (vertical)
bind-key -n M-V split-window -h -c "#{pane_current_path}"
bind-key -n M-W split-window -v -c "#{pane_current_path}"

# Tab picker: Alt-Shift-T (maximized, returns to original on exit/cancel)
bind-key -n M-T choose-tree -Zw

# Window navigation: Alt-n / Alt-Shift-N
bind-key -n M-n next-window
bind-key -n M-N previous-window

# Layout cycling: Alt-t
bind-key -n M-t previous-layout
# (Alt-Shift-T was here, now used for tab picker)

# Copy/scroll mode: Alt-y
bind-key -n M-y copy-mode

# Toggle zoom: Alt-Enter
bind-key -n M-Enter resize-pane -Z

# ── Prefix bindings (Zellij "tmux mode") ──

# Rename window: C / Alt-Shift-C
bind-key C command-prompt -I "#W" "rename-window '%%'"
bind-key M-C command-prompt -I "#W" "rename-window '%%'"

# Window/Tab picker: T (maximized, returns to original on exit/cancel)
bind-key M-T choose-tree -Zw

# Toggle last window: T
bind-key T last-window

# Session picker: W (maximized, returns to original on exit/cancel)
bind-key W choose-tree -Zs

# Focus next pane: a / Alt-a
bind-key a select-pane -t +
bind-key M-a select-pane -t +

# Close window: d / Alt-d
bind-key d kill-window
bind-key M-d kill-window

# Close pane: w
bind-key w kill-pane

# Resize panes: h/j/k/l or Alt-h/j/k/l
bind-key -r h resize-pane -L 5
bind-key -r M-h resize-pane -L 5
bind-key -r j resize-pane -D 5
bind-key -r M-j resize-pane -D 5
bind-key -r k resize-pane -U 5
bind-key -r M-k resize-pane -U 5
bind-key -r l resize-pane -R 5
bind-key -r M-l resize-pane -R 5

# Toggle zoom: i / Alt-i
bind-key i resize-pane -Z
bind-key M-i resize-pane -Z

# Swap pane: s (Zellij move mode approximation)
bind-key s display-panes \; swap-pane -D

# New window: Alt-t
bind-key M-t new-window -c "#{pane_current_path}"

# New session: Alt-g
bind-key M-g new-session

# Search: /
bind-key / copy-mode \; send-keys /

# ── Copy mode (vi bindings, clipboard via OSC 52) ──
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-selection-and-cancel
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send -X copy-selection-and-cancel
